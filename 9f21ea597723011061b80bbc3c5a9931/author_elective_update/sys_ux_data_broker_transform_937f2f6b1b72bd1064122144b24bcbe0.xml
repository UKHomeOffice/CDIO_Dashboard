<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ux_data_broker_transform">
    <sys_ux_data_broker_transform action="DELETE">
        <acl_failure_result/>
        <api_name>sn_ciodashboard.getMetricsOfCIODashboard-LV</api_name>
        <description>This script returns all KPI details used on CIO dashboard on a specific Tab in a JSON format</description>
        <mutates_server_data>false</mutates_server_data>
        <name>getMetricsOfCIODashboard-LV</name>
        <output_schema/>
        <private>false</private>
        <props>[&#13;
  {&#13;
    "name": "tab",&#13;
    "label": "Tab",&#13;
    "description": "Name of Tab (Allowed values Tab1,Tab2,Tab3,Tab4,Tab5,Tab6)",&#13;
    "readOnly": false,&#13;
    "fieldType": "string",&#13;
    "mandatory": true,&#13;
    "defaultValue": ""&#13;
  }&#13;
]</props>
        <required_translations>[ {
  "message" : "Name of Tab (Allowed values Tab1,Tab2,Tab3,Tab4,Tab5,Tab6)",
  "comment" : ""
}, {
  "message" : "Tab",
  "comment" : ""
} ]</required_translations>
        <schema_version>1.0.0</schema_version>
        <script><![CDATA[function transform(input) {
    var transformedJson = {};
    var tabID = input.tab;
    var ciodVerticalGr = new GlideAggregate('sn_ciodashboard_cio_dashboard_metrics_config');
    ciodVerticalGr.groupBy('vertical');
    ciodVerticalGr.orderBy('vertical');
	ciodVerticalGr.orderBy('order');
    ciodVerticalGr.query();

    while (ciodVerticalGr.next()) 
	{
        var cioGr = new GlideRecord('sn_ciodashboard_cio_dashboard_metrics_config');
        cioGr.addQuery('tab', tabID);
        cioGr.addQuery('vertical', ciodVerticalGr.getValue('vertical'));
        cioGr.query();
        var headlineMetrics = [];
        var supportingMetrics = [];


        while (cioGr.next()) 
		{
            var metricLabelKey = cioGr.getDisplayValue('metric_label');
            var metricLabelMsg = gs.getMessage(metricLabelKey);
			
			var metricDefinitionKey = cioGr.getValue('metric_definition');
            var metricDefinitionMsg = gs.getMessage(metricDefinitionKey);
			
			var metricProductKey = cioGr.getDisplayValue('product');
            var metricProductMsg = gs.getMessage(metricProductKey);
			
			var metricApplicationKey = cioGr.getDisplayValue('application');
            var metricApplicationMsg = gs.getMessage(metricApplicationKey);
			
            var obj = {
                'metricLabel': metricLabelMsg,
				'metricDefinition': metricDefinitionMsg,
				'metricProduct': metricProductMsg,
				'metricSysid': cioGr.getValue('metric'),
                'breakdownSysid': cioGr.getValue('breakdown'),
				'metricApplication': metricApplicationMsg
                //'metricLabel': cioGr.getValue('metric_label'),
                //'metricDefinition': cioGr.getValue('metric_definition'),
                //'metricProduct': cioGr.getDisplayValue('product'),
                //'metricApplication': cioGr.getDisplayValue('application')
            };
            if (cioGr.headline_metric == true)
                headlineMetrics.push(obj);
            else
                supportingMetrics.push(obj);
        }
        transformedJson[ciodVerticalGr.getDisplayValue('vertical')] = {
            'headlineMetrics': headlineMetrics,
            'supportingMetrics': supportingMetrics
        };
    }
    return transformedJson;
}]]></script>
        <sys_class_name>sys_ux_data_broker_transform</sys_class_name>
        <sys_created_by>VelentL</sys_created_by>
        <sys_created_on>2023-12-05 15:35:09</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>937f2f6b1b72bd1064122144b24bcbe0</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>getMetricsOfCIODashboard-LV</sys_name>
        <sys_package display_value="CIO Dashboard" source="sn_ciodashboard">9f21ea597723011061b80bbc3c5a9931</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="CIO Dashboard">9f21ea597723011061b80bbc3c5a9931</sys_scope>
        <sys_update_name>sys_ux_data_broker_transform_937f2f6b1b72bd1064122144b24bcbe0</sys_update_name>
        <sys_updated_by>VelentL</sys_updated_by>
        <sys_updated_on>2023-12-05 15:35:09</sys_updated_on>
    </sys_ux_data_broker_transform>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="CIO Dashboard">9f21ea597723011061b80bbc3c5a9931</claim_owner_scope>
        <claim_timestamp>18c4391d8320000001</claim_timestamp>
        <metadata_update_name>sys_ux_data_broker_transform_937f2f6b1b72bd1064122144b24bcbe0</metadata_update_name>
        <previous_claim_app_version>1.0.2</previous_claim_app_version>
        <previous_claim_name>CIO Dashboard</previous_claim_name>
        <previous_claim_scope>9f21ea597723011061b80bbc3c5a9931</previous_claim_scope>
        <sys_created_by>VelentL</sys_created_by>
        <sys_created_on>2023-12-07 09:18:00</sys_created_on>
        <sys_id>cf8cecd01b87f15064122144b24bcb96</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>VelentL</sys_updated_by>
        <sys_updated_on>2023-12-07 09:18:00</sys_updated_on>
    </sys_claim>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="CIO Dashboard">9f21ea597723011061b80bbc3c5a9931</application>
        <file_path/>
        <instance_id>b2b98cc2db2bae00cbf6d5b0cf96197f</instance_id>
        <instance_name>lssidev3</instance_name>
        <name>sys_ux_data_broker_transform_937f2f6b1b72bd1064122144b24bcbe0</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ux_data_broker_transform"&gt;&lt;sys_ux_data_broker_transform action="INSERT_OR_UPDATE"&gt;&lt;acl_failure_result/&gt;&lt;api_name&gt;sn_ciodashboard.getMetricsOfCIODashboard-LV&lt;/api_name&gt;&lt;description&gt;This script returns all KPI details used on CIO dashboard on a specific Tab in a JSON format&lt;/description&gt;&lt;mutates_server_data&gt;false&lt;/mutates_server_data&gt;&lt;name&gt;getMetricsOfCIODashboard-LV&lt;/name&gt;&lt;output_schema/&gt;&lt;private&gt;false&lt;/private&gt;&lt;props&gt;[&amp;#13;
  {&amp;#13;
    "name": "tab",&amp;#13;
    "label": "Tab",&amp;#13;
    "description": "Name of Tab (Allowed values Tab1,Tab2,Tab3,Tab4,Tab5,Tab6)",&amp;#13;
    "readOnly": false,&amp;#13;
    "fieldType": "string",&amp;#13;
    "mandatory": true,&amp;#13;
    "defaultValue": ""&amp;#13;
  }&amp;#13;
]&lt;/props&gt;&lt;required_translations&gt;[ {
  "message" : "Name of Tab (Allowed values Tab1,Tab2,Tab3,Tab4,Tab5,Tab6)",
  "comment" : ""
}, {
  "message" : "Tab",
  "comment" : ""
} ]&lt;/required_translations&gt;&lt;schema_version&gt;1.0.0&lt;/schema_version&gt;&lt;script&gt;&lt;![CDATA[function transform(input) {
    var transformedJson = {};
    var tabID = input.tab;
    var ciodVerticalGr = new GlideAggregate('sn_ciodashboard_cio_dashboard_metrics_config');
    ciodVerticalGr.groupBy('vertical');
    ciodVerticalGr.orderBy('vertical');
	ciodVerticalGr.orderBy('order');
    ciodVerticalGr.query();

    while (ciodVerticalGr.next()) 
	{
        var cioGr = new GlideRecord('sn_ciodashboard_cio_dashboard_metrics_config');
        cioGr.addQuery('tab', tabID);
        cioGr.addQuery('vertical', ciodVerticalGr.getValue('vertical'));
        cioGr.query();
        var headlineMetrics = [];
        var supportingMetrics = [];


        while (cioGr.next()) 
		{
            var metricLabelKey = cioGr.getDisplayValue('metric_label');
            var metricLabelMsg = gs.getMessage(metricLabelKey);
			
			var metricDefinitionKey = cioGr.getValue('metric_definition');
            var metricDefinitionMsg = gs.getMessage(metricDefinitionKey);
			
			var metricProductKey = cioGr.getDisplayValue('product');
            var metricProductMsg = gs.getMessage(metricProductKey);
			
			var metricApplicationKey = cioGr.getDisplayValue('application');
            var metricApplicationMsg = gs.getMessage(metricApplicationKey);
			
            var obj = {
                'metricLabel': metricLabelMsg,
				'metricDefinition': metricDefinitionMsg,
				'metricProduct': metricProductMsg,
				'metricSysid': cioGr.getValue('metric'),
                'breakdownSysid': cioGr.getValue('breakdown'),
				'metricApplication': metricApplicationMsg
                //'metricLabel': cioGr.getValue('metric_label'),
                //'metricDefinition': cioGr.getValue('metric_definition'),
                //'metricProduct': cioGr.getDisplayValue('product'),
                //'metricApplication': cioGr.getDisplayValue('application')
            };
            if (cioGr.headline_metric == true)
                headlineMetrics.push(obj);
            else
                supportingMetrics.push(obj);
        }
        transformedJson[ciodVerticalGr.getDisplayValue('vertical')] = {
            'headlineMetrics': headlineMetrics,
            'supportingMetrics': supportingMetrics
        };
    }
    return transformedJson;
}]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_ux_data_broker_transform&lt;/sys_class_name&gt;&lt;sys_created_by&gt;VelentL&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-12-05 15:35:09&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;937f2f6b1b72bd1064122144b24bcbe0&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;getMetricsOfCIODashboard-LV&lt;/sys_name&gt;&lt;sys_package display_value="CIO Dashboard" source="sn_ciodashboard"&gt;9f21ea597723011061b80bbc3c5a9931&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="CIO Dashboard"&gt;9f21ea597723011061b80bbc3c5a9931&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ux_data_broker_transform_937f2f6b1b72bd1064122144b24bcbe0&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;VelentL&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-12-05 15:35:09&lt;/sys_updated_on&gt;&lt;/sys_ux_data_broker_transform&gt;&lt;sys_claim action="INSERT_OR_UPDATE"&gt;&lt;claim_owner_scope display_value="CIO Dashboard"&gt;9f21ea597723011061b80bbc3c5a9931&lt;/claim_owner_scope&gt;&lt;claim_timestamp&gt;18c4391d8320000001&lt;/claim_timestamp&gt;&lt;metadata_update_name&gt;sys_ux_data_broker_transform_937f2f6b1b72bd1064122144b24bcbe0&lt;/metadata_update_name&gt;&lt;previous_claim_app_version&gt;1.0.2&lt;/previous_claim_app_version&gt;&lt;previous_claim_name&gt;CIO Dashboard&lt;/previous_claim_name&gt;&lt;previous_claim_scope&gt;9f21ea597723011061b80bbc3c5a9931&lt;/previous_claim_scope&gt;&lt;sys_created_by&gt;VelentL&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-12-07 09:18:00&lt;/sys_created_on&gt;&lt;sys_id&gt;cf8cecd01b87f15064122144b24bcb96&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;VelentL&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-12-07 09:18:00&lt;/sys_updated_on&gt;&lt;/sys_claim&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-715892465</payload_hash>
        <record_name>getMetricsOfCIODashboard-LV</record_name>
        <reverted_from/>
        <source>9f21ea597723011061b80bbc3c5a9931</source>
        <source_table>sys_store_app</source_table>
        <state>previous</state>
        <sys_created_by/>
        <sys_created_on>2023-12-05 15:35:09</sys_created_on>
        <sys_id>3059bb8e1ba2ce108f629939b04bcba3</sys_id>
        <sys_mod_count/>
        <sys_recorded_at>18c3a9e67c80000000</sys_recorded_at>
        <sys_updated_by/>
        <sys_updated_on/>
        <type>Data Broker Server Script</type>
        <update_guid>fc59bb8e2ea2ce10d700dafc91b234a2</update_guid>
        <update_guid_history>fc59bb8e2ea2ce10d700dafc91b234a2:-715892465</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete/>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>VelentL</sys_created_by>
        <sys_created_on>2024-06-04 10:21:49</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_db_object display_value="" name="sys_ux_data_broker_transform">sys_ux_data_broker_transform</sys_db_object>
        <sys_id>2bf70250965d46b493077497c4c0ba84</sys_id>
        <sys_metadata>937f2f6b1b72bd1064122144b24bcbe0</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>getMetricsOfCIODashboard-LV</sys_name>
        <sys_package display_value="CIO Dashboard" source="sn_ciodashboard">9f21ea597723011061b80bbc3c5a9931</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="CIO Dashboard">9f21ea597723011061b80bbc3c5a9931</sys_scope>
        <sys_scope_delete display_value="">94cae931f87c423c81291c2bbd3a9864</sys_scope_delete>
        <sys_update_name>sys_ux_data_broker_transform_937f2f6b1b72bd1064122144b24bcbe0</sys_update_name>
        <sys_update_version display_value="sys_ux_data_broker_transform_937f2f6b1b72bd1064122144b24bcbe0">3059bb8e1ba2ce108f629939b04bcba3</sys_update_version>
        <sys_updated_by>VelentL</sys_updated_by>
        <sys_updated_on>2024-06-04 10:21:49</sys_updated_on>
    </sys_metadata_delete>
</record_update>
